---
import SVG from "@/components/SVG.astro";

import { Image } from "astro:assets";
import AoSleepImage from "@/assets/img/ao-sleep.webp";
---

<section>
  <!-- TODO: MEで実装後。こっちは薄いからBlur画像自体なくていいかも -->
  <img
    src="data:image/webp;base64,UklGRkYAAABXRUJQVlA4IDoAAACwAQCdASoJAAMAAQAeJYwCdADdBGGQAP7f5vv5uEZjCidPCVKrviOl/CXrdRyuiDr1S25MlsoGuJAA"
    alt=""
    aria-hidden="true"
  />
  <Image
    id="js-fadeImage"
    data-loaded="false"
    src={AoSleepImage}
    alt="眠る猫の背景画像"
    loading="eager"
  />
  <h1 class="l-content">
    <SVG symbol="logo" alt="WEBA" />
    <p>
      Hi, I design & develop. <br class="u-showSp" />
       This is My Blog & Portfolio.
    </p>
  </h1>
</section>

<script>
  document.addEventListener(
    "astro:page-load",
    () => {
      const fadeImage = document.getElementById("js-fadeImage");

      fadeImage?.complete && fadeImage.setAttribute("data-loaded", "true");
      fadeImage?.addEventListener("load", () => {
        fadeImage.setAttribute("data-loaded", "true");
      });
    },
    { once: false },
  );
</script>

<style lang="less">
  @import "@/styles/common.less";

  #js-fadeImage {
    opacity: 0;
    transition: opacity 0.4s ease-in;
    &[data-loaded="true"] {
      opacity: 1;
    }
  }

  section {
    display: grid;
    height: 240px;
    margin-bottom: -48px;
    > * {
      grid-area: 1/-1;
    }
    &::after {
      content: "";
      grid-area: 1/-1;
      backdrop-filter: blur(2px);
      background-image: radial-gradient(
        ellipse 160% 100% at top center,
        rgba(@base, 0.8) 70%,
        rgba(@base, 1) 100%
      );
      background-size: 100%;
    }
  }
  img {
    width: 100%;
    height: 100%;
    min-height: 0;
    object-fit: cover;
    object-position: right;
  }
  h1 {
    z-index: 1;
    margin-block: auto;
    :global(svg) {
      color: rgba(@theme, 0.9);
      width: 160px;
      height: 40px;
      filter: drop-shadow(0 0 24px rgba(@base, 1));
    }
    p {
      color: rgba(@label, 0.7);
      font-size: 14px;
      font-weight: 400;
      letter-spacing: 0.1em;
    }
  }
</style>
